---
layout: post
header-img: img/default-blog-pic.jpg
author: sunil.inteti
description: 
post_id: 344
created: 2007/12/11 14:49:04
created_gmt: 2007/12/11 12:49:04
comment_status: open
---

# Security Protocols and common attacks.

<p>I wanted to write a blog on Security Protocols. This was the course I liked the most during my College days. Lets look at some protocols and some of the ways these protocols can be attacked. These are some protocols that i studied during my college days.</p>
<p>The two most common words in Security world is Confidentiality and Integrity. Understanding these two terms is very crucial. In simple words Confidentiality means that only authorized entities can read information. Integrity means reassuring the recipient of the message that the message has not been altered since it was generated by a legitimate source.<!--more-->
In Public Key Cryptography
---Each user U has an encryption function E<sub>u</sub>that is made public.
---Each user U has a decryption function (key) Du that is non-public.
D<sub>u</sub>(E<sub>u</sub>(m)) = m
 The encryption function E<sub>u</sub> can be revealed without revealing the decryption function D<sub>u</sub>
As we Know Confidentiality can be provided by Encryption . Integrity can be provided by using digital signatures.</p>
<p>Lets plunge into some example protocol with the famous Alice and Bob example.
Now lets look at a session establishment protocol and some attacks on it. A protocol to establish a session key K between Alice and Bob must guarantee the following two properties.</p>
<p>After successful protocol execution:
     <ul>
 <li>  Only Alice and Bob (and TTP's involved if any. TTP is a trusted third party involved in   generation of a session key) should   know    K.
  Alice and Bob should be assured that K is newly generated.</li>
</ul></p>
<p>An Adversary can do the any of the following</p>
<ul>
<li>Eavesdrop on all messages sent in a protocol
Alter all messages sent in a protocol using any information available
Re-route any message to any principal
Generate and insert completely new messages
Obtain the value of the session key used in any sufficiently old previous run of the protocol
Start any number of parallel protocol runs between any principals.</li></ul>

<p>Some Encryption assumptions are involved in Encryption.
The encryption of message M with key K (shared or public) is denoted by ciphertext {M}<sub>K</sub></p>
<p>Assumptions:
    <ul>
<li>Without K or matching private key, it should be impossible to retrieve M from {M}<sub>K</sub>
It should be impossible to retrieve K or matching private key from {M}<sub>K</sub>
Without K even with knowledge of M it should be impossible to alter {M}<sub>K</sub>without being detected
</li></ul></p>
<p>Here is what the notations used in this blog mean
{K}<sub>K<sub>AT</sub></sub> --- K is encrypted with shared key between Alice and Trent.  K<sub>AT</sub>  is known to both Alice and Trent.</p>
<p><img src="http://xebee.xebia.in/wp-content/uploads/2007/12/1.gif" alt="1.gif" /></p>
<p>Here Trent is the trusted third party.
In the first step Alice sends a message to Trent saying that it wants to have a session with Bob.
Trent finds keys K<sub>AT</sub> , K<sub>BT</sub>, generates K at random, creates {K}<sub>AT</sub> , {K}<sub>BT</sub> which are the shared keys between Alice and Trent, Bob and Trent respectively.
Alice decrypts {K}<sub>K<sub>AT</sub></sub> to get K.. Bob decrypts {K}<sub>K<sub>BT</sub></sub> to get K. And from now on Alice and Bob can communicate with key K.
Now lets look at the attack on this protocol.
<img src="http://xebee.xebia.in/wp-content/uploads/2007/12/2.gif" alt="2" /></p>
<pre><code>&lt;ul&gt;
</code></pre>
<p><li>Mallory(one who tries to break rules,may be a valid principal ) intercepts Alice’s message intended for Trent.</p>
<p>Trent thinks Alice wants key with Mallory.</p>
<p>Alice is fooled that Mallory is Bob.</p>
<p>Attacker is (also) a legitimate principal.</p>
<p>Here Mallory impersonates as Bob and Alice is made to believe it.
</li>
</ul></p>
<p>FIX FOR THE ATTACK:</p>
<p><img src="http://xebee.xebia.in/wp-content/uploads/2007/12/3.gif" alt="3" /></p>
<p>This protocol binds the session key to the intended users</p>
<p>If Mallory tries the previous attack, then Trent will include Mallory’s identity in the encrypted part intended for Alice, so she knows the decrypted key is not shared with Bob and therefore the attack will fail</p>
<p>YET ANOTHER ATTACK ON THIS IMPROVED PROTOCOL</p>
<p><img src="http://xebee.xebia.in/wp-content/uploads/2007/12/4.gif" alt="4" /></p>
<p>Mallory records exchange between Alice and Bob as shown in the above figure.</p>
<p>Mallory replays messages in subsequent run like in the second step of the protocol</p>
<p>Here are some points to note</p>
<pre><code>&lt;ul&gt;
</code></pre>
<p><li>K’ is a not fresh</p>
<p>But Alice does not know about this.</p>
<p>K’ is known to Mallory. And Mallory can again fool Alice.</p>
<p>This attack is called a replay/freshness attack.
</li></ul></p>
<p>The fix here is to challenge and expect a response so that No one can play replay attacks.</p>
<p>So here is the improved protocol</p>
<p><img src="http://xebee.xebia.in/wp-content/uploads/2007/12/5.gif" alt="5" /></p>
<p>Alice (Bob) checks if Trent is there</p>
<pre><code>&lt;ul&gt;
</code></pre>
<p><li>Sends random challenge to Trent</p>
<p>Trent responds with a message that binds the challenge to the session key as you can see in the second step of the new protocol above.</p>
<p>Alice (Bob) verify the binding before accepting the key</li></ul></p>
<p>Since Alice (Bob) expects a different response each time, Mallory cannot replay an old response without detection</p>
<p>This method is called challenge-response.</p>
<p>NA is called the nonce and its the challenge sent by Alice to Trent and trent responds for it. So a reply is always a fresh one. Now mallory canont replay the messages like it could in the previos version of the protocol.</p>
<p>This brand new protocol includes 2 challenge response exchanges. One is between Alice an Trent and other is between Bob and Alice.</p>
<pre><code>&lt;ul&gt;
</code></pre>
<p><li>Bob checks if Alice is there</p>
<p>Sends challenge to A (Message 4)</p>
<p>Response should be fresh (Message 5)</li></ul></p>
<p>Friends unfortunately there is another attack on this improved protocol as well. Can You guess it???!!!!! [:)]</p>